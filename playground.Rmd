---
title: "load_map.rmd"
author: "Magnus Bendix Borregaard"
date: "4/20/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(raster)
library(sf)
library(leaflet)

aarhus <- brick('data/32VNH_0_B08,B04,B03.tiff')
# aarhus_raster_test <- raster('data/32VNH_0_B08,B04,B03.tiff')

bbox(aarhus)
crs(aarhus)
plotRGB(aarhus)
```

## Loading Roads
```{r}

roads_4326 <- st_read('data/osm-roads/gis_osm_roads_free_1.shp')

roads_3857 <- st_transform(roads_4326 , crs = crs(aarhus)) # transform roads crs to match raster

compareCRS(roads_3857, crs(aarhus)) # keep this as a sanity check

aarhus_box <- st_make_grid(aarhus, n = 1) # bounding box of satellite image

roads_cropped <- st_intersection(aarhus_box, roads_3857)


leaflet() %>%
  addProviderTiles("OpenStreetMap") %>%
  #addRasterImage(aarhus_raster_test) %>% # does not work with a brick, but should work with the raster heatmap
  addPolylines(data = st_transform(roads_cropped, crs = 4326)) %>%
  setView(lng = 10.2, lat = 56.15, zoom = 11) # Aarhus
  

```